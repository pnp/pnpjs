
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://pnp.github.io/pnpjs/queryable/behaviors/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Behaviors - PnP/PnPjs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
    <img src="https://telemetry.sharepointpnp.com/@pnp/pnpjs/ghpages/pnpjs/queryable/behaviors/" alt="spacer" width="1" height="1" />

    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pnpqueryable-behaviors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://pnp.github.io/pnpjs/" title="PnP/PnPjs" class="md-header-nav__button md-logo" aria-label="PnP/PnPjs">
      
  <img src="../../img/Logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            PnP/PnPjs
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Behaviors
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pnp/pnpjs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://pnp.github.io/pnpjs/" title="PnP/PnPjs" class="md-nav__button md-logo" aria-label="PnP/PnPjs">
      
  <img src="../../img/Logo.png" alt="logo">

    </a>
    PnP/PnPjs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pnp/pnpjs/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../transition-guide/" class="md-nav__link">
      V2->V3 Transition
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Year in Review
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Year in Review" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Year in Review
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../news/2021-year-in-review/" class="md-nav__link">
      2021
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../news/2020-year-in-review/" class="md-nav__link">
      2020
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Library Usage Tips
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Library Usage Tips" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Library Usage Tips
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/authentication/" class="md-nav__link">
      Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/batching/" class="md-nav__link">
      Batching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/batching-caching/" class="md-nav__link">
      Batching & Caching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/custom-bundle/" class="md-nav__link">
      Custom Bundling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/error-handling/" class="md-nav__link">
      Error-Handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/project-preset/" class="md-nav__link">
      Project Presets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/selective-imports/" class="md-nav__link">
      Selective Imports
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/typings/" class="md-nav__link">
      Typings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/behaviors/" class="md-nav__link">
      Using Behaviors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Packages
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Packages" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Packages
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../packages/" class="md-nav__link">
      Packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      core
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="core" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        <span class="md-nav__icon md-icon"></span>
        core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="/packages/#core" class="md-nav__link">
      core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/behaviors/" class="md-nav__link">
      behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/observers/" class="md-nav__link">
      observers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/moments/" class="md-nav__link">
      moments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/timeline/" class="md-nav__link">
      timeline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/storage/" class="md-nav__link">
      storage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/util/" class="md-nav__link">
      util
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      graph
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="graph" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        <span class="md-nav__icon md-icon"></span>
        graph
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="/packages/#graph" class="md-nav__link">
      graph
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/behaviors/" class="md-nav__link">
      Behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/groups/" class="md-nav__link">
      groups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/groups/" class="md-nav__link">
      groups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/insights/" class="md-nav__link">
      insights
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/contacts/" class="md-nav__link">
      contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/cloud-communications/" class="md-nav__link">
      cloud communications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/calendars/" class="md-nav__link">
      calendars
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/directoryobjects/" class="md-nav__link">
      directory objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/invitations/" class="md-nav__link">
      invitations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/onedrive/" class="md-nav__link">
      onedrive
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/outlook/" class="md-nav__link">
      outlook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/photos/" class="md-nav__link">
      photos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/planner/" class="md-nav__link">
      planner
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/search/" class="md-nav__link">
      search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/subscriptions/" class="md-nav__link">
      subscriptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/teams/" class="md-nav__link">
      teams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../graph/users/" class="md-nav__link">
      users
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      logging
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="logging" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        <span class="md-nav__icon md-icon"></span>
        logging
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../logging/" class="md-nav__link">
      logging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      msaljsclient
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="msaljsclient" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        <span class="md-nav__icon md-icon"></span>
        msaljsclient
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../msaljsclient/" class="md-nav__link">
      msaljsclient
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      nodejs
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="nodejs" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        <span class="md-nav__icon md-icon"></span>
        nodejs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="/packages/#nodejs" class="md-nav__link">
      nodejs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../nodejs/behaviors/" class="md-nav__link">
      behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../nodejs/sp-extensions/" class="md-nav__link">
      sp Extensions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7" checked>
    
    <label class="md-nav__link" for="nav-6-7">
      queryable
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="queryable" data-md-level="2">
      <label class="md-nav__title" for="nav-6-7">
        <span class="md-nav__icon md-icon"></span>
        queryable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="/packages/#queryable" class="md-nav__link">
      Queryable
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Behaviors
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Behaviors
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bearer-token" class="md-nav__link">
    Bearer Token
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#browserfetch" class="md-nav__link">
    BrowserFetch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#browserfetchwithretry" class="md-nav__link">
    BrowserFetchWithRetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    Caching
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-key-function" class="md-nav__link">
    Custom Key Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-pessimistic-refresh" class="md-nav__link">
    Caching Pessimistic Refresh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#injectheaders" class="md-nav__link">
    InjectHeaders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parsers" class="md-nav__link">
    Parsers
  </a>
  
    <nav class="md-nav" aria-label="Parsers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defaultparse" class="md-nav__link">
    DefaultParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#textparse" class="md-nav__link">
    TextParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blobparse" class="md-nav__link">
    BlobParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsonparse" class="md-nav__link">
    JSONParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufferparse" class="md-nav__link">
    BufferParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headerparse" class="md-nav__link">
    HeaderParse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resolvers" class="md-nav__link">
    Resolvers
  </a>
  
    <nav class="md-nav" aria-label="Resolvers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolveondata-rejectonerror" class="md-nav__link">
    ResolveOnData, RejectOnError
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout" class="md-nav__link">
    Timeout
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../extensions/" class="md-nav__link">
      Extensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../queryable/" class="md-nav__link">
      Queryable
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-8" type="checkbox" id="nav-6-8">
    
    <label class="md-nav__link" for="nav-6-8">
      sp
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="sp" data-md-level="2">
      <label class="md-nav__title" for="nav-6-8">
        <span class="md-nav__icon md-icon"></span>
        sp
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="/packages/#sp" class="md-nav__link">
      sp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/behaviors/" class="md-nav__link">
      Behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/alias-parameters/" class="md-nav__link">
      Alias Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/alm/" class="md-nav__link">
      ALM api
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/attachments/" class="md-nav__link">
      Attachments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/clientside-pages/" class="md-nav__link">
      Client-side Pages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/column-defaults/" class="md-nav__link">
      Column Defaults
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/comments-likes/" class="md-nav__link">
      Comments and Likes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/content-types/" class="md-nav__link">
      Content Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/features/" class="md-nav__link">
      Features
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/fields/" class="md-nav__link">
      Fields
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/files/" class="md-nav__link">
      Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/folders/" class="md-nav__link">
      Folders
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/forms/" class="md-nav__link">
      Forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/hubsites/" class="md-nav__link">
      Hubsites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/items/" class="md-nav__link">
      List Items
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/lists/" class="md-nav__link">
      Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/navigation/" class="md-nav__link">
      Navigation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/permissions/" class="md-nav__link">
      Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/profiles/" class="md-nav__link">
      Profiles
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/regional-settings/" class="md-nav__link">
      Regional Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/related-items/" class="md-nav__link">
      Related Items
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/search/" class="md-nav__link">
      Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/security/" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/sharing/" class="md-nav__link">
      Sharing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/site-designs/" class="md-nav__link">
      Site Designs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/site-groups/" class="md-nav__link">
      Site Groups
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/site-scripts/" class="md-nav__link">
      Site Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/site-users/" class="md-nav__link">
      Site Users
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/sites/" class="md-nav__link">
      Sites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/social/" class="md-nav__link">
      Social
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/sp-utilities-utility/" class="md-nav__link">
      SP.Utilities.Utility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/subscriptions/" class="md-nav__link">
      Subscriptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/taxonomy/" class="md-nav__link">
      Taxonomy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/tenant-properties/" class="md-nav__link">
      Tenant Properties
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/user-custom-actions/" class="md-nav__link">
      User custom actions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/views/" class="md-nav__link">
      Views
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sp/webs/" class="md-nav__link">
      Webs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Advanced
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Advanced" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/custom-bundle/" class="md-nav__link">
      Custom Bundle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/invokable/" class="md-nav__link">
      Custom Call/Path
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/behaviors/" class="md-nav__link">
      Behaviors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/behavior-recipes/" class="md-nav__link">
      Behavior Recipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/timeline/" class="md-nav__link">
      Timeline/Moments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../concepts/adv-clientside-pages/" class="md-nav__link">
      Client-Side Pages
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Contributing
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Contributing" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/setup-dev-machine/" class="md-nav__link">
      Set Up Dev Machine
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/settings/" class="md-nav__link">
      Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/timeline/" class="md-nav__link">
      Understanding Library Internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/extending-the-library/" class="md-nav__link">
      Expanding the Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/npm-scripts/" class="md-nav__link">
      Npm Scripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/local-debug-configuration/" class="md-nav__link">
      Local Debug Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/debugging/" class="md-nav__link">
      Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/debug-tests/" class="md-nav__link">
      Tests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/documentation/" class="md-nav__link">
      Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../contributing/pull-requests/" class="md-nav__link">
      Pull Requests
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Legacy Docs
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Legacy Docs" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Legacy Docs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../v1/" class="md-nav__link">
      V1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../v2/" class="md-nav__link">
      V2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bearer-token" class="md-nav__link">
    Bearer Token
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#browserfetch" class="md-nav__link">
    BrowserFetch
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#browserfetchwithretry" class="md-nav__link">
    BrowserFetchWithRetry
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    Caching
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custom-key-function" class="md-nav__link">
    Custom Key Function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-pessimistic-refresh" class="md-nav__link">
    Caching Pessimistic Refresh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#injectheaders" class="md-nav__link">
    InjectHeaders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parsers" class="md-nav__link">
    Parsers
  </a>
  
    <nav class="md-nav" aria-label="Parsers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#defaultparse" class="md-nav__link">
    DefaultParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#textparse" class="md-nav__link">
    TextParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blobparse" class="md-nav__link">
    BlobParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jsonparse" class="md-nav__link">
    JSONParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bufferparse" class="md-nav__link">
    BufferParse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headerparse" class="md-nav__link">
    HeaderParse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resolvers" class="md-nav__link">
    Resolvers
  </a>
  
    <nav class="md-nav" aria-label="Resolvers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resolveondata-rejectonerror" class="md-nav__link">
    ResolveOnData, RejectOnError
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeout" class="md-nav__link">
    Timeout
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pnp/pnpjs/tree/version-3/docs/queryable/behaviors.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="pnpqueryable-behaviors">@pnp/queryable : behaviors<a class="headerlink" href="#pnpqueryable-behaviors" title="Permanent link">&para;</a></h1>
<p>The article describes the behaviors exported by the <code>@pnp/queryable</code> library. Please also see available behaviors in <a href="../../core/behaviors/">@pnp/core</a>, <a href="../../nodejs/behaviors/">@pnp/nodejs</a>, <a href="../../sp/behaviors/">@pnp/sp</a>, and <a href="../../graph/behaviors/">@pnp/graph</a>.</p>
<p>Generally you won't need to use these behaviors individually when using the defaults supplied by the library, but when appropriate you can create your own <a href="../../core/behavior-recipes/">composed behaviors</a> using these as building blocks.</p>
<h2 id="bearer-token">Bearer Token<a class="headerlink" href="#bearer-token" title="Permanent link">&para;</a></h2>
<p>Allows you to inject an existing bearer token into the request. This behavior will <em>not replace</em> any existing authentication behaviors, so you may want to ensure they are cleared if you are supplying your own tokens, regardless of their source. This behavior does no caching or performs any operation other than including your token in an authentication heading.</p>
<pre><code class="language-TypeScript">import { BearerToken } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BearerToken(&quot;HereIsMyBearerTokenStringFromSomeSource&quot;));

// optionally clear any configured authentication as you are supplying a token so additional calls shouldn't be needed
// but take care as other behaviors may add observers to auth
sp.on.auth.clear();

// the bearer token supplied above will be applied to all requests made from `sp`
const webInfo = await sp.webs();
</code></pre>
<h2 id="browserfetch">BrowserFetch<a class="headerlink" href="#browserfetch" title="Permanent link">&para;</a></h2>
<p>This behavior, for use in web browsers, provides basic fetch support through the browser's fetch global method. It replaces any other registered observers on the send moment by default, but this can be controlled via the props. Remember, when registering observers on the send moment only the first one will be used so not replacing</p>
<blockquote>
<p>For fetch configuration in nodejs please see <a href="../../nodejs/behaviors/">@pnp/nodejs behaviors</a>.</p>
</blockquote>
<pre><code class="language-TypeScript">import { BrowserFetch } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BrowserFetch());

const webInfo = await sp.webs();
</code></pre>
<pre><code class="language-TypeScript">import { BrowserFetch } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BrowserFetch({ replace: false }));

const webInfo = await sp.webs();
</code></pre>
<h2 id="browserfetchwithretry">BrowserFetchWithRetry<a class="headerlink" href="#browserfetchwithretry" title="Permanent link">&para;</a></h2>
<p>This behavior makes fetch requests but will attempt to retry the request on certain failures such as throttling.</p>
<pre><code class="language-TypeScript">import { BrowserFetchWithRetry } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BrowserFetchWithRetry());

const webInfo = await sp.webs();
</code></pre>
<p>You can also control how the behavior works through its props. The <code>replace</code> value works as described above for BrowserFetch. <code>interval</code> specifies the initial dynamic back off value in milliseconds. This value is ignored if a "Retry-After" header exists in the response. <code>retries</code> indicates the number of times to retry before failing the request, the default is 3. A default of 3 will result in up to 4 total requests being the initial request and threee potential retries.</p>
<pre><code class="language-TypeScript">import { BrowserFetchWithRetry } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BrowserFetchWithRetry({
    retries: 2,
    interval: 400,
    replace: true,
}));

const webInfo = await sp.webs();
</code></pre>
<h2 id="caching">Caching<a class="headerlink" href="#caching" title="Permanent link">&para;</a></h2>
<p>This behavior allows you to cache the results of get requests in either session or local storage. If neither is available (such as in Nodejs) the library will shim using an in memory map. It is a good idea to include caching in your projects to improve performance. By default items in the cache will expire after 5 minutes.</p>
<pre><code class="language-TypeScript">import { Caching } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(Caching());

// caching will save the data into session storage on the first request - the key is based on the full url including query strings
const webInfo = await sp.webs();

// caching will retriece this value from the cache saving a network requests the second time it is loaded (either in the same page, a reload of the page, etc.)
const webInfo2 = await sp.webs();
</code></pre>
<h3 id="custom-key-function">Custom Key Function<a class="headerlink" href="#custom-key-function" title="Permanent link">&para;</a></h3>
<p>You can also supply custom functionality to control how keys are generated and calculate the expirations.</p>
<p>The cache key factory has the form <code>(url: string) =&gt; string</code> and you must ensure your keys are unique enough that you won't have collisions.</p>
<p>The expire date factory has the form <code>(url: string) =&gt; Date</code> and should return the Date when the cached data should expire. If you know that some particular data won't expire often you can set this date far in the future, or for more frequently updated information you can set it lower. If you set the expiration too short there is no reason to use caching as any stored information will likely always be expired. Additionally, you can set the storage to use local storage which will persist across sessions.</p>
<pre><code class="language-TypeScript">import { getHashCode, PnPClientStorage, dateAdd, TimelinePipe } from &quot;@pnp/core&quot;;
import { Caching } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(Caching({
    store: &quot;local&quot;,
    // use a hascode for the key
    keyFactory: (url) =&gt; getHashCode(url.toLowerCase()).toString(),
    // cache for one minute
    expireFunc: (url) =&gt; dateAdd(new Date(), &quot;minute&quot;, 1),
}));

// caching will save the data into session storage on the first request - the key is based on the full url including query strings
const webInfo = await sp.webs();

// caching will retriece this value from the cache saving a network requests the second time it is loaded (either in the same page, a reload of the page, etc.)
const webInfo2 = await sp.webs();
</code></pre>
<p>As with any behavior you have the option to only apply caching to certain requests:</p>
<pre><code class="language-TypeScript">import { getHashCode, dateAdd } from &quot;@pnp/core&quot;;
import { Caching } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;
import &quot;@pnp/sp/lists&quot;;
import &quot;@pnp/sp/items&quot;;

const sp = spfi();

// caching will only apply to requests using `cachingList` as the base of the fluent chain
const cachingList = sp.web.lists.getByTitle(&quot;{List Title}&quot;).using(Caching());

// caching will save the data into session storage on the first request - the key is based on the full url including query strings
const itemsInfo = await cachingList.items();

// caching will retriece this value from the cache saving a network requests the second time it is loaded (either in the same page, a reload of the page, etc.)
const itemsInfo2 = await cachingList.items();
</code></pre>
<h2 id="caching-pessimistic-refresh">Caching Pessimistic Refresh<a class="headerlink" href="#caching-pessimistic-refresh" title="Permanent link">&para;</a></h2>
<p>This behavior is slightly different than our default Caching behavior in that it will always return the cached value if there is one, but also asyncronously update the cached value in the background. Like the default CAchine behavior it allows you to cache the results of get requests in either session or local storage. If neither is available (such as in Nodejs) the library will shim using an in memory map.</p>
<p>If you do not provide an expiration function then the cache will be updated asyncronously on every call, if you do provide an expiration then the cached value will only be updated, although still asyncronously, only when the cache has expired.</p>
<pre><code class="language-TypeScript">import { CachingPessimisticRefresh } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(CachingPessimisticRefresh());

// caching will save the data into session storage on the first request - the key is based on the full url including query strings
const webInfo = await sp.webs();

// caching will retriece this value from the cache saving a network requests the second time it is loaded (either in the same page, a reload of the page, etc.)
const webInfo2 = await sp.webs();
</code></pre>
<p>Again as with the default Caching behavior you can provide custom functions for key generation and expiration. Please see the <a href="#Custom-Key-Function">Custom Key Function documentation above</a> for more details.</p>
<h2 id="injectheaders">InjectHeaders<a class="headerlink" href="#injectheaders" title="Permanent link">&para;</a></h2>
<p>Adds any specified headers to a given request. Can be used multiple times with a timeline. The supplied headers are added to all requests, and last applied wins - meaning if two InjectHeaders are included in the pipeline which inlcude a value for the same header, the second one applied will be used.</p>
<pre><code class="language-TypeScript">import { InjectHeaders } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(InjectHeaders({
    &quot;X-Something&quot;: &quot;a value&quot;,
    &quot;MyCompanySpecialAuth&quot;: &quot;special company token&quot;,
}));

const webInfo = await sp.webs();
</code></pre>
<h2 id="parsers">Parsers<a class="headerlink" href="#parsers" title="Permanent link">&para;</a></h2>
<p>Parsers convert the returned fetch Response into something usable. We have included the most common parsers we think you'll need - but you can always write your own parser based on the <a href="../queryable/#parse">signature of the parse moment</a>.</p>
<blockquote>
<p>All of these parsers when applied through using will replace any other observers on the parse moment.</p>
</blockquote>
<h3 id="defaultparse">DefaultParse<a class="headerlink" href="#defaultparse" title="Permanent link">&para;</a></h3>
<p>Performs error handling and parsing of JSON responses. This is the one you'll use for most of your requests and it is included in all the defaults.</p>
<pre><code class="language-TypeScript">import { DefaultParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(DefaultParse());

const webInfo = await sp.webs();
</code></pre>
<h3 id="textparse">TextParse<a class="headerlink" href="#textparse" title="Permanent link">&para;</a></h3>
<p>Checks for errors and parses the results as text with no further manipulation.</p>
<pre><code class="language-TypeScript">import { TextParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(TextParse());
</code></pre>
<h3 id="blobparse">BlobParse<a class="headerlink" href="#blobparse" title="Permanent link">&para;</a></h3>
<p>Checks for errors and parses the results a Blob with no further manipulation.</p>
<pre><code class="language-TypeScript">import { BlobParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BlobParse());
</code></pre>
<h3 id="jsonparse">JSONParse<a class="headerlink" href="#jsonparse" title="Permanent link">&para;</a></h3>
<p>Checks for errors and parses the results as JSON with no further manipulation. Meaning you will get the raw JSON response vs DefaultParse which will remove wrapping JSON.</p>
<pre><code class="language-TypeScript">import { JSONParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(JSONParse());
</code></pre>
<h3 id="bufferparse">BufferParse<a class="headerlink" href="#bufferparse" title="Permanent link">&para;</a></h3>
<p>Checks for errors and parses the results a Buffer with no further manipulation.</p>
<pre><code class="language-TypeScript">import { BufferParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(BufferParse());
</code></pre>
<h3 id="headerparse">HeaderParse<a class="headerlink" href="#headerparse" title="Permanent link">&para;</a></h3>
<p>Checks for errors and parses the headers of the Response as the result. This is a specialised parses which can be used in those infrequent scenarios where you need information from the headers of a response.</p>
<pre><code class="language-TypeScript">import { HeaderParse } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(HeaderParse());
</code></pre>
<h2 id="resolvers">Resolvers<a class="headerlink" href="#resolvers" title="Permanent link">&para;</a></h2>
<p>These two behaviors are special and should always be included when composing your own defaults. They implement the expected behavior of resolving or rejecting the promise returned when executing a timeline. They are implemented as behaviors should there be a need to do something different the logic is not locked into the core of the library.</p>
<h3 id="resolveondata-rejectonerror">ResolveOnData, RejectOnError<a class="headerlink" href="#resolveondata-rejectonerror" title="Permanent link">&para;</a></h3>
<pre><code class="language-TypeScript">import { ResolveOnData, RejectOnError } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const sp = spfi().using(ResolveOnData(), RejectOnError());
</code></pre>
<h2 id="timeout">Timeout<a class="headerlink" href="#timeout" title="Permanent link">&para;</a></h2>
<p>The Timeout behavior allows you to include a timeout in requests. You can specify either a number, representing the number of milliseconds until the request should timeout or an AbortSignal.</p>
<blockquote>
<p>In Nodejs you will need to polyfill <code>AbortController</code> if your version (&lt;15) does not include it when using Timeout and passing a number. If you are supplying your own AbortSignal you do not.</p>
</blockquote>
<pre><code class="language-TypeScript">import { Timeout } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

// requests should timeout in 5 seconds
const sp = spfi().using(Timeout(5000));
</code></pre>
<pre><code class="language-TypeScript">import { Timeout } from &quot;@pnp/queryable&quot;;

import &quot;@pnp/sp/webs&quot;;

const controller = new AbortController();

const sp = spfi().using(Timeout(controller.signal));

// abort requests after 6 seconds using our own controller
const timer = setTimeout(() =&gt; {
    controller.abort();
}, 6000);

// this request will be cancelled if it doesn't complete in 6 seconds
const webInfo = await sp.webs();

// be a good citizen and cancel unneeded timers
clearTimeout(timer);
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../nodejs/sp-extensions/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                sp Extensions
              </div>
            </div>
          </a>
        
        
          <a href="../extensions/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Extensions
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://twitter.com/m365pnpjs" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="http://aka.ms/sppnp-videos" target="_blank" rel="noopener" title="aka.ms" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://aka.ms/sppnp" target="_blank" rel="noopener" title="aka.ms" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 32h214.6v214.6H0V32zm233.4 0H448v214.6H233.4V32zM0 265.4h214.6V480H0V265.4zm233.4 0H448V480H233.4V265.4z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>